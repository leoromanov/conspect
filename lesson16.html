<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Адаптивная графика</title>
    <link rel="stylesheet" href="./css/style_lesson14.css">
</head>
<body class="container">
    <h1>Экраны высокой пиксельной плотности</h1>
    <h2>Ретина</h2>
    <p>
        Ретина (retina) - маркетинговый термин компании Apple, описывающий устройства с экранами повышенной пиксельной плотности. В тот же физический размер экрана вмещается больше пикселей, за счёт того что их размер меньше. Это повышает качество и чёткость изображения на экране.
    </p>
    <img src="./images/retina-showcase.png" alt="">
    <h2>Физические пиксели</h2>
    <img src="./images/device-pixels.png" alt="">
    <p>
        Физические пиксели (device pixel или hardware pixel) — самые маленькие элементы любого экрана (его матрицы), каждый из которых имеет свой цвет и яркость.
    </p>
    <h2>Разрешение экрана</h2>
    <p>
        Разрешение экрана (screen resolution) - количество физических пикселей на экране устройства. Приводится нерешённым, что дополнительно говорит о соотношении.

Например, разрешение 1920x1080 означает что экран 1920 физических пикселей по ширине и 1080 по высоте. Если умножить получится общее количество пикселей на таком экране - 2073600.
    </p>
    <h2>Плотность экрана</h2>
    <p>
        Плотность экрана (screen density или pixel density) - это количество физических пикселей, которое помещается в один дюйм. Измеряется в ppi (pixels per inch). Чем выше плотность, тем меньше размер пикселя и тем больше их на экране.
    </p>
    <img src="./images/pixel-density.png" alt="">
    <h2>CSS-пиксели</h2>
    <p>
        CSS-пиксели (CSS pixels, device-independent pixels) — абстрактная величина, используемая браузерами для точного отображения контента на страницах, вне зависимости от экрана. На дисплеях стандартной плотности один CSS-пиксель соответствует одному физическому пикселю устройства.
    </p>
    <img src="./images/css-pixels.png" alt="">
    <p>
        Например, есть блок размером 2x2 CSS-пикселя. Все размеры элементов, которые указываются в CSS или HTML, это CSS-пиксели
    </p>
    <img src="./images/css-pixel1.JPG" alt="">
    <p>
        На обычных экранах он будет занимать область 2x2 физических пикселей, а на Retina-экранах, например с плотностью 2, этот же блок получит 4x4 физических пикселей. То есть в два раза больше по горизонтали и в два раза больше по вертикали. Таким образом, на Retina-экранах с плотностью пикселей в два раза выше стандартной, количество пикселей в 4 раза больше, чем на обычных.
    </p>
    <img src="./images/css-pixel-scaling.png" alt="">
    <div class="advice">
        <b>ВНИМАНИЕ</b>
        <p>
            CSS-пиксель это абстрактная величина не зависящая от экрана устройства. При масштабировании и на экранах высокой пиксельной плотность, в одном CSS-пикселе может помешаться больше одного физического пикселя.
        </p>
    </div>
    <h2>Растровые пиксели</h2>
    <p>
        Растровые пиксели (bitmap pixels) - самые маленькие части, составляющие растровое изображение (png, jpg, gif и т.д.) Каждый пиксель содержит информацию о цвете и расположении в системе координат изображения.
    </p>
    <img src="./images/bitmap-pixels.png" alt="">
    <p>
        Кроме растрового разрешения, изображениям задаются размеры в CSS-пикселях. Браузер сжимает или растягивает изображение в соответствии с его CSS-шириной и длиной. При отображении на обычном экране один растровый пиксель соответствует одному CSS-пикселю. На Retina-экранах с плотностью 2, каждый растровый пиксель умножается в 4 раза, что приводит к потере качества изображения не подготовленного к ретине.
    </p>
    <img src="./images/bitmap-pixels-retina.png" alt="">
    <div class="advice">
        <b>ВНИМАНИЕ</b>
        <p>
            Векторная графика отображается одинаково хорошо на экранах с любой плотностью пикселей.
        </p>
    </div>
        <h2>Ретинизация графики</h2>
        <p>
            Для ретины необходимы специально подготовленные ресурсы. Текст и SVG-графика отображаются везде одинаково, так как их рендерит сам браузер по набору точек и соединяющих их кривых. Ретинизация это приём для подготовки растровой графики.
        </p>
        <p>
            Самый простой способ подготовить растровую графику к ретине - это экспортировать из макета большое изображение. Например, чтобы показать фотографию 200x300 пикселей на ретине с плотностью 2, необходимо подготовить её вариант в размере 400x600 пикселей.
        </p>
        <p>
            Процесс подготовки состоит из экспорта изображений x1, x2 и x3 размера от оригинала под каждую плотность и сохранения их с соответствующими префиксами @2x и @3x, для оригинала префикс не нужен.
        </p>
        <img src="./images/bitmap-export.png" alt="">
        <p>
            После чего достаточно задать нужный размер тегу <img> используя HTML или CSS.
        </p>
        <img src="./images/retina_sizing.JPG" alt="">
        <p>
            В примере используется онлайн-сервис изображений. Загружается три картинки 320x240 (x1), 640x480 (x2) и 960x720 (x3) пикселей. Размер всех элементов <img> одинаковый - 320x240 CSS-пикселей. Если перейти в пример с телефона или просто увеличить масштаб страницы с примером, будет заметно что первое изображения сильно размывается, второе остаётся вполне качественным, а третье всегда кристально чёткое.
        </p>
        <img src="./images/retina_sizing1.JPG" alt="">
        <div class="attention">
            <b>ВНИМАНИЕ</b>
            <p>
                Это не значит что всегда нужно экспортировать и загружать максимально большое изображение. На этом шаге мы рассмотрели проблему и научились делать ретинизацию растровой графики. Далее в этом занятии мы научимся загружать различные изображения под каждую ширину или плотность экрана.
            </p>
        </div>


        <h1>Отзывчивые изображения</h1>
        <p>
            Представьте изображение 1200x600 пикселей. Оно отлично выглядит на широком экране. А что будет, когда мы откроем страницу, скажем на телефоне или планшете? Ничего хорошего, по умолчанию изображение будет оставаться шириной 1200px и появится полоса горизонтальной прокрутки. На ретине такое изображение потеряет качество. А что насчёт веса изображения, действительно нужна ли нам картинка 1200x600 для телефона с экраном 320px? Нет, не нужна.
        </p>
        <p>
            <b>Отзывчивые изображения</b> - это термин для описания набора приёмов используемых в HTML и CSS, при помощи которых контентные и фоновые изображения выглядят одинаково хорошо на устройствах с различными размерами и плотностью экрана.
        </p>
        <p>
            Самый простой способ реализовать отзывчивость, это использовать одно изображение для всех устройств, задав ему определённый набор CSS-свойств.
        </p>
        <img src="./images/resize-img.JPG" alt="">
        <ul>
            <li>
                Блочным изображение неободимо сделать чтобы убрать нижний «зазор» строчного элемента.
            </li>
            <li>
                Если максимальной ширине задано значение 100%, изображение будет уменьшаться, если необходимо, но никогда не растянется больше чем 100% своей оригинальной ширины (чтобы не терять качество изображения).
            </li>
            <li>
                Свойству height задаётся значение auto, для того чтобы изображение сохраняло оригинальные пропорции при изменении ширины.
            </li>
        </ul>
        <img src="./images/basic-reposnsive-image.png" alt="">
        <p>
            Так будет работать техника простого отзывчивого изображения - одна картинка для всех устройств, которая подстраивается под текущую ширину экрана.
        </p>
        <div class="advice">
            <b>ВНИМАНИЕ</b>
            <p>
                Этот базоый подход для контентных изображений слишком простой и не решает проблему ретина-экранов и веса большого изображения на мобильных устройствах, но это хороший старт.
            </p>
        </div>
        <h1>Отзывчивые фоновые изображения</h1>
        <p>
            Если необходимо добавить ретинизированное фоновое изображение, нужно указать путь к изображению и обязательно задать размер фона элемента равным размеру самого элемента.
        </p>
        <img src="./images/bgc-resize.JPG" alt="">
        <p>
            В случае когда размер элемента динамический и узнать его в CSS невозможно, размеру фона можно задать значения contain или cover, по ситуации, чтобы фон помещался в элементе.
        </p>
        <img src="./images/bgc-resize1.JPG" alt="">
        <p>
            При таком подходе мы получим 2x изображение на любом экране. Поэтому существуют медиа-функции позволяющие определить плотность пикселей экрана в CSS. Внутри набора таких медиа-функций, переопределяем значение свостйва background-image.
        </p>
        <img src="./images/bgc-resize2.JPG" alt="">
        <p>
            В медиа-функции min-device-pixel-ratio указывается просто значение пиксельной плотности экрана как число - коэфициент между физическими и CSS-пикселями. Так же необходимо указать функцию min-resolution с двумя разными значениями.
        </p>
        <ul>
            <li>
                dpi (dots per inch) - количество физических пикселей на дюйм экрана. На экранах стандартной плотности пикселей в одном дюйме 96 точек.
            </li>
            <li>
                dppx (dots per pixel) - количество физических пикселей в одном CSS-пикселе, другими словами это плотность пикселей. 1dppx = 96dpi.
            </li>
        </ul>
        <p>
            Медиа-функция min-device-pixel-ratio поддерживается некоторыми браузерами только с вендорным префиксом, поэтому если обработать этот код автопрефиксером получим финальный вариант.
        </p>
        <img src="./images/bgc-resize3.JPG" alt="">
        <div class="advice">
            <b>ВНИМАНИЕ</b>
            <p>
                Такая солянка из медиа-функций и их значений нужна потому что они еще не стандартизированы между всеми браузерами.
            </p>
        </div>
        <p>
            В примере задано одинаковое фоновое изображение в различных размерах для экранов с плотностью пикселей 1x, 2x и 3x.
        </p>
        <img src="./images/bgc-resize4.JPG" alt="">
        <h1>Отзывчивый элемент IMG</h1>
        <p>
            Отзывчивый тег img используется браузером для загрузки только подходящего под текущее устройство изображения из предложенных разработчиком. Такой подход повышает скорость загрузки и отображаения страницы, так как вес изображения оказывает большое влияние на эти параметры.
        </p>
        <img src="./images/responsive-img-tag.png" alt="">
        <p>
            Разработчик указывает список доступных к загрузке изображений, а браузер, основываясь на размере экрана устройства и его пиксельной плотности, выбирает самое подходящее.
        </p>
        <p>
            Например, разработчик указал два доступных изображения - 300×300 и 600×600 пикселей. Если браузеру достаточно картинки 300×300, это четырёхкратная экономия веса загружаемого изображения. Чем меньше размер экрана устройства, тем больше выгода от такого подхода. Экономия трафика на мобильном устройстве может достигать 70-90% по сравнению с десктопом.
        </p>

        <h2>Атрибут SRCSET</h2>
        <p>
            Определяет список версий одного и того же изображения разных размеров. Не стоит пытаться загрузить разные изображения (по контенту или формату) при помощи этой техники, браузер обращает внимание только на размер и считает что всё что передают в srcset это версии одного и того же изображения.
        </p>
        <img src="./images/srcset.JPG" alt="">

        <h2>Дескриптор Х</h2>
        <p>
            Самый простой способ использования отзывчивого тега <img> это применение дескриптора x в атрибуте srcset, который буквально указывает браузеру для какой плотности экрана подходит та или иная версия изображения.
        </p>
        <img src="/images/descript.JPG" alt="">
        <p>
            В атрибуте src указывается версия изображения в самом плохом качестве (x1), потому что оно самое маленькое. В атрибуте srcset добавили x2 версию изображения для ретины с плотностью 2. Если страница будет открыта в браузере на устройстве с плотностью пикселей 2 или выше, вместо дефолтной будет использована эта версия photo@2x.jpg.
        </p>
        <p>
            В srcset можно перечислить сколько угодно вариантов изображения и их дескрипторов, разделив объявления запятой.
        </p>
        <img src="./images/srcset1.JPG" alt="">
        <p>
            В примере указаны изображения для 2x и 3x плотностей, в два и три раза больше оригинала, а так же оригинальное изображение по умолчанию для 1x.
        </p>
        <img src="./images/srcset2.JPG" alt="">
        <p>
            При входе с Macbook Pro 15" 2017, плотность пикселей экрана которого составляет 2, браузер загрузит изображение у которого указан дескриптор 2x.
        </p>
        <img src="./images/srcset-x-example.png" alt="">
        <p>
            Недостаток этого подхода кроется в ограниченности критериев по которым браузер выбирает изображение - только плотность пикселей экрана. Отзывчивые изображения используются в отзывчивой вёрстке, размеры блоков в котрой изменяются в зависимости от размера вьпорта.
        </p>
        <p>
            Задать жёсткие размеры изображения на экране не всегда возможно, потому что при увеличении вьюпорта необходимо будет показывать изображение 300x200 в блоке размерами 600x400 пикселей или больше
        </p>
        <p>
            Идеально если бы браузер мог выбрать изображения не только по плотности пикселей, но еще учитывал текущий размер вьюпорта и размер самой картинки на экране. Для этого ему необходимо знать размер оригинального изображения в предлагаемом списке. Как раз эту задачу и решает дескритор w и атрибут sizes.
        </p>

        <h2>Дескриптор W</h2>
        <p>
            Мы по-прежнему предоставляем одно и то же изображение в разных размерах, но при этом даём браузеру больше информации, чтобы он мог сам выбрать необходимое изображение, исходя из плотности пикселей, размера вьюпорта, скорости сетевого подключения и оригинального размера изображения.
        </p>
        <img src="./images/descriptw.JPG" alt="">
        <p>
            Помечая каждое изображение дескриптором w, в котором указана ширина этого изображения в пикселях, мы перекладываем все вычисления и выбор изображения на браузер.
        </p>
        <div class="advice">
            <b>СОВЕТ</b>
            <p>
                Если изображение photo-600.jpg размером 600x400 пикселей, то помечем его дескриптором 600w. В имени изображения так же указываем его физическую ширину, чтобы не забыть, так как версий изображения будет довольно много.
            </p>
        </div>

        <h2>Атрибут SIZES </h2>
        <p>
            При использовании дескриптора w, то есть при привязке к физическим рамзерам изображения, необходимо использовать атрибут sizes, чтобы подсказать браузеру приблизительный размер холста на котором в браузере будет отрисовываться изображение. Это упростит браузеру задачу выбора правильного изображения. Размеры можно указывать как в пикселях, так и в относительных единицах.
        </p>
        <p>
            Например, если изображение на экране всегда будет 300px, достаточно указать одно значение.
        </p>
        <img src="./images/sizes.JPG" alt="">
        <p>
            В случае когда изображение должно быть на 100% ширины вьюпорта на мобильных устройствах до 600px, 300px на экранах 601-900px и 600px на экранах шире, значение sizes будет включать в себя медиа-запросы.
        </p>
        <img src="./images/sizes1.JPG" alt="">
        <ul>
            <li>
                (min-width: 601px) 300px - при ширине вьюпорта от 601px, размер изображения 300px
            </li>
            <li>
                (min-width: 901px) 600px - при ширине вьюпорта от 901px, размер изображения 600px
            </li>
            <li>
                100vw - полная ширина вьюпорта, значение по умолчанию, указывается последним
            </li>
        </ul>

        <h2>Как браузер выбирает</h2>
        <p>
            Бразуер выбирает картинку по довольно простому алгоритму - умножает ширину вьюпорта на плотность пикселей, учитывает размер картинки на экране и выбирает ближайшее подходящее по размеру изображение.
        </p>
        <img src="./images/responsive-img-pixel-ratio.png" alt="">
        <p>
            На илюстрации показан десктоп и смартфон с шириной изображения 100% ширины вьюпорта.
        </p>
        <ul>
            <li>
                1680 * 2 = 3360 - на илюстрации это img-3000x1768.png для десктопа.
            </li>
            <li>
                375 * 3 = 1125 - на илюстрации это img-1200x714.png для смартфона.
            </li>
        </ul>
        <p>
            В случае когда в sizes задано фиксированное значение ширины изображения, браузер умножит его на плотность экрана. Например, sizes установлен в 300px.
        </p>
        <ul>
            <li>
                300 * 2 = 600 - для десктопа будет взято изображение максимально близкое к 600px.
            </li>
            <li>
                300 * 3 = 900 - для смартфона будет взято изображение максимально близкое к 900px.
            </li>
        </ul>
        <p>
            Стоп, то есть для мобильного устройства будет взято большее изображение?! - ИМЕННО ТАК! В этом вся суть, браузер выбирает то изображение, которое лучше всего подходит в данной ситуации.
        </p>
        <div class="webinar">
            <b>ИНТЕРЕСНО</b>
            <p>
                Потому что в отличии от разработчика, который знает только размер изображения и приблизительный размер холста на котором оно будет отображаться, браузер знает все важные технические характеристики устройства на котором была открыта веб-страница. Кроме того браузер может учитывать другие факторы, такие как скорость интернет-соединения и состояние заряда батареи.
            </p>
        </div>

        <h1>Элемент PICTURE</h1>
        <p>
            Как мы уже разобрались, тег <img> с атрибутами srcset и sizes позволяет загружать разные версии (размеры) одного и того же изображения, например для поддержки ретины. Тег <picture> используется в случае когда необходимо загрузить различные по геометрии изображения (кадрирование), изображения для поддержки режима тёмной темы оформления (prefers-color-scheme) или изображения разного формата (расширения).
        </p>
        <img src="./images/responsive-img-tag.png" alt="">
        <p>
            В каждой ситуации необходимо использовать правильный инструмент, возможно вам будет достаточно отзывчивого тега img, не обязательно везде применять picture.
        </p>

        <h2>Синтаксис</h2>
        <img src="./images/picture.JPG" alt="">
        <p>
            Элемент <picture> служит контейнером для одного или более элементов source и одного обязательного элемента img.
        </p>
        <ul>
            <li>
                Браузер проверит каждый из элементов source и выберет самый подходящий. Чтобы выбрать оптимальное изображение, браузер анализирует атрибуты srcset, media, и type.
            </li>
            <li>
                Если ни один из вариантов не подойдёт, будет выбрано изображение указанное в атрибуте src элемента img.
            </li>
            <li>
                Выбранное изображение рисуется на холсте который занимает элемент img.
            </li>
        </ul>

        <h2>Атрибут TYPE</h2>
        <p>
            Позволяет обозначить <a href="https://developer.mozilla.org/ru/docs/Web/HTTP/Basics_of_HTTP/MIME_types">MIME-тип</a> данных, указанных в атрибуте srcset. Если браузер не подерживает данный тип, то этот элемент source пропускается.
        </p>
        <img src="./images/pic-type.JPG" alt="">

        <h2>Атрибут MEDIA</h2>
        <p>
            Позволяет определить медиа-запрос, который браузер будет анализировать для выбора элемента source. Если медиа-запрос определяется как ложный (не подходит), то этот элемент source пропускается.
        </p>
        <img src="./images/pic-media.JPG" alt="">

        <h1>Поддержка современных форматов</h1>
        <p>
            Элемент picture можно применять для загрузки изображений в современных форматах (например webp). Для браузеров которые не поддерживают такие форматы, указывается дефолное изображение в альтернативном формате (например jpg или png).
        </p>
        <p>
            Следующий пример определяет элемент picture, который по умолчанию позволит браузерам загрузить photo.webp, при этом предоставляется альтернатива photo.jpg для браузеров которые еще не поддерживают этот формат.
        </p>
        <img src="./images/pic-webp.JPG" alt="">
        <p>
            Все варианты доступных изображений перечисляются в тегах source, которые будут последовально обрабатываться браузером.
        </p>
        <div class="advice">
            <b>ПОЛЕЗНО</b>
            <p>
                Самый простой способ сконвертировать изображения в формат webp - использовать онлайн-инструменты, например <a href="https://squoosh.app/">squoosh.app</a> .
            </p>
        </div>

        <h2>Атрибут SRCSET</h2>
        <p>
            Аналогично функционалу в теге img, позволяет указать набор вариантов изображений с дескрипторами x или w.
        </p>
        <img src="./images/srcset3.JPG" alt="">

        <h2>Кадрирование art-direction</h2>
        <img src="./images/art-direction.png" alt="">
        <p>
            Техника кадрирования используется для загрузки различных изображений для каждого экрана. Это позволяет показать пользователю максимум полезной информации и деталей изображения даже на маленьких устройствах. Например, загружать альбомную (landscape) или книжную (portrait) версию изображения в зависимости от ориентации или разрешения устройства.
        </p>
        <p>
            Перейдите в пример и изменяйте ширину окна браузера.
        </p>
        <ul>
            <li>
                Для экранов шириной до 500px будет загружено портретное изображение 500x600 пикселей.
            </li>
            <li>
                Для экранов шириной от 800px и шире, будет загружено ландшафтное изображение 1200x400 пикселей.
            </li>
            <li>
                Для экранов шириной от 501px до 799px, будет загружено ландшафтное изображение 800x400 пикселей.
            </li>
        </ul>

        <img src="./images/artdirection.JPG" alt="">


    



</body>
